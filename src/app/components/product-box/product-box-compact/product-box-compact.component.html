<div class="ProductBoxCompact" [ngClass]="{ 'ProductBoxCompact--inOrder': product.orderItem }">
  <a [routerLink]="product | productUrl: activeCategory" class="ProductBoxCompact-link">
    <rr-shop-image [images]="product.images" [size]="Size.Px0200" class="ProductBoxCompact-image"></rr-shop-image>
    <span>{{ product.name }}</span>
  </a>

  <div class="ProductBoxCompact-price">
    {{ product.priceUnit | price }}
  </div>

  <ng-container *ngIf="product.orderItem">
    <div class="ProductBoxCompact-alreadyInBasketQuantityAndActions">
      <div class="ProductBoxCompact-alreadyInBasketQuantity">
        W koszyku: <b>{{ product.orderItem.quantity }}</b>
      </div>
      <div class="ProductBoxCompact-alreadyInBasketActions">
        <rr-shop-clickable-action
          *ngIf="!product.orderItem.isQuantityDecrementActive()"
          (actionClick)="remove(product.orderItem.id)"
          [icon]="['far', 'trash-alt']"
        ></rr-shop-clickable-action>
        <rr-shop-clickable-action
          *ngIf="product.orderItem.isQuantityDecrementActive()"
          (actionClick)="quantityDecrement(product.orderItem.id)"
          [icon]="['fas', 'minus']"
        ></rr-shop-clickable-action>
        <rr-shop-clickable-action
          (actionClick)="quantityIncrement(product.orderItem.id)"
          [icon]="['fas', 'plus']"
        ></rr-shop-clickable-action>
        <!-- TODO fix increment button: [disabled]="!product.orderItem.isQuantityIncrementActive()" -->
      </div>
    </div>

    <div
      *ngIf="product.orderItem.isProductQuantityExceededTextVisible()"
      class="ProductBoxCompact-alreadyInBasketNotification u-form-error-container"
    >
      Niestety nie posiadamy tylu sztuk produktu na magazynie :(
      <br />
      Dostępnych na magazynie: <b>{{ product.quantity }}</b>
    </div>

    <div
      *ngIf="product.orderItem.isProductQuantityReached()"
      class="ProductBoxCompact-alreadyInBasketNotification u-form-warning-container"
    >
      Nie można dodać więcej sztuk
      <br />
      Dostępnych na magazynie: <b>{{ product.quantity }}</b>
    </div>
  </ng-container>

  <div *ngIf="!product.orderItem" class="ProductBoxCompact-notInBasketYet">
    <rr-shop-clickable-action
      *ngIf="product.quantity !== 0; else notAvailable"
      (actionClick)="addToOrder(product)"
      [label]="'Do koszyka'"
      [icon]="['fas', 'shopping-basket']"
    ></rr-shop-clickable-action>

    <ng-template #notAvailable>
      <span>Produkt niedostępny</span>
    </ng-template>
  </div>
</div>
